# Everything goes into ElasticSearch
<label @FWD>
#  <filter {nova.**,neutron.**,keystone.**,glance.**,cinder.**,heat.**,ceilometer.**,sahara.**,trove.**,ironic.**}>
#  <match nova.**>
#    @type rewrite_tag_filter
#    enable_ruby
#    rewriterule1 context (.+) context.${tag}
#openstack { "class": defined? context ? "${context}" : ""}
#      openstack { "context": "${context}", "class": "${class}"}
#  </match>
  <filter **>
    @type record_transformer
    enable_ruby
    auto_typecast true
    <record>
      normalizer {"hostname": "asherkho-centos7-normalizer.os1.phx2.redhat.com", "inputname": "forward", "name": "fluentd-normalizer"}
    </record>
  </filter>
  <filter **>
    @type record_transformer
    enable_ruby
    auto_typecast true
    <record>
      pipeline_metadata {"normalizer": {"hostname": "asherkho-centos7-normalizer.os1.phx2.redhat.com", "inputname": "forward", "name": "fluentd-normalizer"}, "@version": "2016.03.10.0", "received_at" : "${Time.now.utc.strftime(\"%Y-%m-%dT%H:%M:%S.%6N\")}"}
    </record>
    remove_keys normalizer
  </filter>
  <match **>
    @type            elasticsearch
    hosts            elasticsearch.perf.lab.eng.bos.redhat.com:80
    logstash_format  true
    include_tag_key  true
    tag_key          fluentd:tag
    flush_interval   1s
    logstash_prefix  v2016.03.10.0-viaq
    type_name        openstack
    request_timeout  120s
  </match>
</label>
